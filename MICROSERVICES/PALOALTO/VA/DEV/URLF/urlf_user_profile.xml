<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<ObjectDefinition>  <information>
    <configType>xml</configType>
    <defaultDisplay>false</defaultDisplay>
    <description/>
    <displayField>object_id</displayField>
    <dynamic>false</dynamic>
    <group>Objects|Security Profiles</group>
    <icon>/images/repository/CommandDefinition/icons/lan to lan.jpg</icon>
    <importIfMandatoryPresent>false</importIfMandatoryPresent>
    <importrank>1</importrank>
    <name>URL Filtering Profile</name>
    <order>5</order>
    <relatedObjects/>
    <reorderinstances>false</reorderinstances>
    <singleton>false</singleton>
    <sortascending>true</sortascending>
    <sortauto>true</sortauto>
    <sortnumerical>true</sortnumerical>
    <sortvariable>params._order</sortvariable>
    <visibility>5</visibility>
    <visible>true</visible>
  </information>  <variables frozen="1">
    <variable numberOfRowMax="3000" displayName="Profile name" displayOrder="0" maxLength="200" name="params.object_id" type="String"/>
    <variable numberOfRowMax="3000" displayName="license expired" displayOrder="1" editable="false" maxLength="150" name="params.license_expired" type="String" visible="false">
      <values>
        <value displayValue="allow">allow</value>
        <value displayValue="block">block</value>
      </values>
    </variable>
    <variable numberOfRowMax="3000" default="no" displayName="enable container page" displayOrder="2" maxLength="150" name="params.enable_container_page" type="String" visible="false">
      <values>
        <value displayValue="no">no</value>
        <value displayValue="yes">yes</value>
      </values>
    </variable>
    <variable numberOfRowMax="3000" default="no" displayName="dynamic_url" displayOrder="3" editable="false" maxLength="150" name="params.dynamic_url" type="String" visible="false">
      <values>
        <value displayValue="no">no</value>
        <value displayValue="yes">yes</value>
      </values>
    </variable>
    <variable numberOfRowMax="3000" default="no" displayName="log container page only" displayOrder="4" editable="false" maxLength="150" name="params.log_container_page_only" type="String" visible="false">
      <values>
        <value displayValue="no">no</value>
        <value displayValue="yes">yes</value>
      </values>
    </variable>
    <variable numberOfRowMax="3000" displayName="Description" displayOrder="5" maxLength="150" name="params.description" type="String"/>
    <variable numberOfRowMax="3000" displayName="Alert" displayOrder="6" editable="false" maxLength="220" name="params.alert.0.member" type="Index">
      <values>
        <value>abortion</value>
        <value>abused-drugs</value>
        <value>adult</value>
        <value>alcohol-and-tobacco</value>
        <value>auctions</value>
        <value>business-and-economy</value>
        <value>computer-and-internet-info</value>
        <value>content-delivery-networks</value>
        <value>dating</value>
        <value>educational-institutions</value>
        <value>entertainment-and-arts</value>
        <value>financial-services</value>
        <value>gambling</value>
        <value>games</value>
        <value>government</value>
        <value>hacking</value>
        <value>health-and-medicine</value>
        <value>home-and-garden</value>
        <value>hunting-and-fishing</value>
        <value>internet-communications-and-telephony</value>
        <value>internet-portals</value>
        <value>job-search</value>
        <value>legal</value>
        <value>malware</value>
        <value>military</value>
        <value>motor-vehicles</value>
        <value>music</value>
        <value>news</value>
        <value>not-resolved</value>
        <value>nudity</value>
        <value>online-storage-and-backup</value>
        <value>parked</value>
        <value>peer-to-peer</value>
        <value>personal-sites-and-blogs</value>
        <value>philosophy-and-political-advocacy</value>
        <value>phishing</value>
        <value>private-ip-addresses</value>
        <value>proxy-avoidance-and-anonymizers</value>
        <value>questionable</value>
        <value>real-estate</value>
        <value>recreation-and-hobbies</value>
        <value>reference-and-research</value>
        <value>religion</value>
        <value>search-engines</value>
        <value>sex-education</value>
        <value>shareware-and-freeware</value>
        <value>shopping</value>
        <value>social-networking</value>
        <value>society</value>
        <value>sports</value>
        <value>stock-advice-and-tools</value>
        <value>streaming-media</value>
        <value>swimsuits-and-intimate-apparel</value>
        <value>training-and-tools</value>
        <value>translation</value>
        <value>travel</value>
        <value>unknown</value>
        <value>weapons</value>
        <value>web-advertisements</value>
        <value>web-based-email</value>
        <value>web-hosting</value>
      </values>
      <indexVariables>
        <var>params.block.0.member</var>
        <var>params.continue.0.member</var>
      </indexVariables>
    </variable>
    <variable numberOfRowMax="3000" displayName="Block" displayOrder="8" editable="false" maxLength="220" name="params.block.0.member" type="Index">
      <values>
        <value>abortion</value>
        <value>abused-drugs</value>
        <value>adult</value>
        <value>alcohol-and-tobacco</value>
        <value>auctions</value>
        <value>business-and-economy</value>
        <value>computer-and-internet-info</value>
        <value>content-delivery-networks</value>
        <value>dating</value>
        <value>educational-institutions</value>
        <value>entertainment-and-arts</value>
        <value>financial-services</value>
        <value>gambling</value>
        <value>games</value>
        <value>government</value>
        <value>hacking</value>
        <value>health-and-medicine</value>
        <value>home-and-garden</value>
        <value>hunting-and-fishing</value>
        <value>internet-communications-and-telephony</value>
        <value>internet-portals</value>
        <value>job-search</value>
        <value>legal</value>
        <value>malware</value>
        <value>military</value>
        <value>motor-vehicles</value>
        <value>music</value>
        <value>news</value>
        <value>not-resolved</value>
        <value>nudity</value>
        <value>online-storage-and-backup</value>
        <value>parked</value>
        <value>peer-to-peer</value>
        <value>personal-sites-and-blogs</value>
        <value>philosophy-and-political-advocacy</value>
        <value>phishing</value>
        <value>private-ip-addresses</value>
        <value>proxy-avoidance-and-anonymizers</value>
        <value>questionable</value>
        <value>real-estate</value>
        <value>recreation-and-hobbies</value>
        <value>reference-and-research</value>
        <value>religion</value>
        <value>search-engines</value>
        <value>sex-education</value>
        <value>shareware-and-freeware</value>
        <value>shopping</value>
        <value>social-networking</value>
        <value>society</value>
        <value>sports</value>
        <value>stock-advice-and-tools</value>
        <value>streaming-media</value>
        <value>swimsuits-and-intimate-apparel</value>
        <value>training-and-tools</value>
        <value>translation</value>
        <value>travel</value>
        <value>unknown</value>
        <value>weapons</value>
        <value>web-advertisements</value>
        <value>web-based-email</value>
        <value>web-hosting</value>
      </values>
      <indexVariables>
        <var>params.alert.0.member</var>
        <var>params.continue.0.member</var>
      </indexVariables>
    </variable>
    <variable numberOfRowMax="3000" displayName="Continue" displayOrder="9" editable="false" maxLength="220" name="params.continue.0.member" type="Index">
      <values>
        <value>abortion</value>
        <value>abused-drugs</value>
        <value>adult</value>
        <value>alcohol-and-tobacco</value>
        <value>auctions</value>
        <value>business-and-economy</value>
        <value>computer-and-internet-info</value>
        <value>content-delivery-networks</value>
        <value>dating</value>
        <value>educational-institutions</value>
        <value>entertainment-and-arts</value>
        <value>financial-services</value>
        <value>gambling</value>
        <value>games</value>
        <value>government</value>
        <value>hacking</value>
        <value>health-and-medicine</value>
        <value>home-and-garden</value>
        <value>hunting-and-fishing</value>
        <value>internet-communications-and-telephony</value>
        <value>internet-portals</value>
        <value>job-search</value>
        <value>legal</value>
        <value>malware</value>
        <value>military</value>
        <value>motor-vehicles</value>
        <value>music</value>
        <value>news</value>
        <value>not-resolved</value>
        <value>nudity</value>
        <value>online-storage-and-backup</value>
        <value>parked</value>
        <value>peer-to-peer</value>
        <value>personal-sites-and-blogs</value>
        <value>philosophy-and-political-advocacy</value>
        <value>phishing</value>
        <value>private-ip-addresses</value>
        <value>proxy-avoidance-and-anonymizers</value>
        <value>questionable</value>
        <value>real-estate</value>
        <value>recreation-and-hobbies</value>
        <value>reference-and-research</value>
        <value>religion</value>
        <value>search-engines</value>
        <value>sex-education</value>
        <value>shareware-and-freeware</value>
        <value>shopping</value>
        <value>social-networking</value>
        <value>society</value>
        <value>sports</value>
        <value>stock-advice-and-tools</value>
        <value>streaming-media</value>
        <value>swimsuits-and-intimate-apparel</value>
        <value>training-and-tools</value>
        <value>translation</value>
        <value>travel</value>
        <value>unknown</value>
        <value>weapons</value>
        <value>web-advertisements</value>
        <value>web-based-email</value>
        <value>web-hosting</value>
      </values>
      <indexVariables>
        <var>params.block.0.member</var>
        <var>params.alert.0.member</var>
      </indexVariables>
    </variable>
    <variable numberOfRowMax="3000" displayName="Allow URL list" displayOrder="11" maxLength="150" name="params.allow_list.0.url" type="String"/>
    <variable numberOfRowMax="3000" displayName="Block URL list" displayOrder="12" maxLength="150" name="params.block_list.0.url" type="String"/>
    <variable numberOfRowMax="3000" default="block" displayName="Action" displayOrder="14" editable="false" isMandatory="true" maxLength="150" name="params.action" type="String">
      <values>
        <value>alert</value>
        <value>block</value>
        <value>continue</value>
        <value>override</value>
      </values>
    </variable>
  </variables>  <example>
    <content>&lt;url-filtering&gt;
   &lt;entry name="USER_URL_Config_VM-vFW"&gt;
     &lt;license-expired&gt;allow&lt;/license-expired&gt;
     &lt;enable-container-page&gt;yes&lt;/enable-container-page&gt;
     &lt;dynamic-url&gt;yes&lt;/dynamic-url&gt;
     &lt;log-container-page-only&gt;yes&lt;/log-container-page-only&gt;
     &lt;description&gt;VM &amp;gt; vFW&lt;/description&gt;
     &lt;alert&gt;
       &lt;member&gt;abortion&lt;/member&gt;
       &lt;member&gt;adult-and-pornography&lt;/member&gt;
       &lt;member&gt;alcohol-and-tobacco&lt;/member&gt;
       &lt;member&gt;auctions&lt;/member&gt;
       &lt;member&gt;cheating&lt;/member&gt;
       &lt;member&gt;computer-and-internet-security&lt;/member&gt;
       &lt;member&gt;content-delivery-networks&lt;/member&gt;
       &lt;member&gt;cult-and-occult&lt;/member&gt;
       &lt;member&gt;dating&lt;/member&gt;
       &lt;member&gt;dead-sites&lt;/member&gt;
       &lt;member&gt;dynamically-generated-content&lt;/member&gt;
       &lt;member&gt;educational-institutions&lt;/member&gt;
       &lt;member&gt;entertainment-and-arts&lt;/member&gt;
       &lt;member&gt;fashion-and-beauty&lt;/member&gt;
       &lt;member&gt;financial-services&lt;/member&gt;
       &lt;member&gt;games&lt;/member&gt;
       &lt;member&gt;government&lt;/member&gt;
       &lt;member&gt;gross&lt;/member&gt;
       &lt;member&gt;hacking&lt;/member&gt;
       &lt;member&gt;hate-and-racism&lt;/member&gt;
       &lt;member&gt;health-and-medicine&lt;/member&gt;
       &lt;member&gt;home-and-garden&lt;/member&gt;
       &lt;member&gt;hunting-and-fishing&lt;/member&gt;
       &lt;member&gt;illegal&lt;/member&gt;
       &lt;member&gt;image-and-video-search&lt;/member&gt;
       &lt;member&gt;individual-stock-advice-and-tools&lt;/member&gt;
       &lt;member&gt;internet-communications&lt;/member&gt;
       &lt;member&gt;internet-portals&lt;/member&gt;
       &lt;member&gt;job-search&lt;/member&gt;
       &lt;member&gt;kids&lt;/member&gt;
       &lt;member&gt;legal&lt;/member&gt;
       &lt;member&gt;local-information&lt;/member&gt;
       &lt;member&gt;marijuana&lt;/member&gt;
       &lt;member&gt;military&lt;/member&gt;
       &lt;member&gt;motor-vehicles&lt;/member&gt;
       &lt;member&gt;news-and-media&lt;/member&gt;
       &lt;member&gt;not-resolved&lt;/member&gt;
       &lt;member&gt;nudity&lt;/member&gt;
       &lt;member&gt;online-gambling&lt;/member&gt;
       &lt;member&gt;online-greeting-cards&lt;/member&gt;
       &lt;member&gt;online-music&lt;/member&gt;
       &lt;member&gt;online-personal-storage&lt;/member&gt;
       &lt;member&gt;pay-to-surf&lt;/member&gt;
       &lt;member&gt;personal-sites-and-blogs&lt;/member&gt;
       &lt;member&gt;philosophy-and-political-advocacy&lt;/member&gt;
       &lt;member&gt;private-ip-addresses&lt;/member&gt;
       &lt;member&gt;questionable&lt;/member&gt;
       &lt;member&gt;real-estate&lt;/member&gt;
       &lt;member&gt;recreation-and-hobbies&lt;/member&gt;
       &lt;member&gt;reference-and-research&lt;/member&gt;
       &lt;member&gt;religion&lt;/member&gt;
       &lt;member&gt;search-engines&lt;/member&gt;
       &lt;member&gt;sex-education&lt;/member&gt;
       &lt;member&gt;shareware-and-freeware&lt;/member&gt;
       &lt;member&gt;shopping&lt;/member&gt;
       &lt;member&gt;social-networking&lt;/member&gt;
       &lt;member&gt;society&lt;/member&gt;
       &lt;member&gt;sports&lt;/member&gt;
       &lt;member&gt;streaming-media&lt;/member&gt;
       &lt;member&gt;swimsuits-and-intimate-apparel&lt;/member&gt;
       &lt;member&gt;training-and-tools&lt;/member&gt;
       &lt;member&gt;translation&lt;/member&gt;
       &lt;member&gt;travel&lt;/member&gt;
       &lt;member&gt;unknown&lt;/member&gt;
       &lt;member&gt;violence&lt;/member&gt;
       &lt;member&gt;weapons&lt;/member&gt;
       &lt;member&gt;web-advertisements&lt;/member&gt;
       &lt;member&gt;web-based-email&lt;/member&gt;
       &lt;member&gt;web-hosting&lt;/member&gt;
     &lt;/alert&gt;
     &lt;block&gt;
       &lt;member&gt;abused-drugs&lt;/member&gt;
       &lt;member&gt;bot-nets&lt;/member&gt;
       &lt;member&gt;confirmed-spam-sources&lt;/member&gt;
       &lt;member&gt;keyloggers-and-monitoring&lt;/member&gt;
       &lt;member&gt;malware-sites&lt;/member&gt;
       &lt;member&gt;open-http-proxies&lt;/member&gt;
       &lt;member&gt;parked-domains&lt;/member&gt;
       &lt;member&gt;peer-to-peer&lt;/member&gt;
       &lt;member&gt;phishing-and-other-frauds&lt;/member&gt;
       &lt;member&gt;proxy-avoidance-and-anonymizers&lt;/member&gt;
       &lt;member&gt;spam-urls&lt;/member&gt;
       &lt;member&gt;spyware-and-adware&lt;/member&gt;
       &lt;member&gt;unconfirmed-spam-sources&lt;/member&gt;
     &lt;/block&gt;
     &lt;continue&gt;
       &lt;member&gt;business-and-economy&lt;/member&gt;
     &lt;/continue&gt;
     &lt;block-list&gt;
       &lt;member&gt;www.bad.com&lt;/member&gt;
       &lt;member&gt;worth.com&lt;/member&gt;
     &lt;/block-list&gt;
     &lt;allow-list&gt;
       &lt;member&gt;www.good.com&lt;/member&gt;
       &lt;member&gt;great.com&lt;/member&gt;
     &lt;/allow-list&gt;
     &lt;action&gt;block&lt;/action&gt;
   &lt;/entry&gt;
&lt;/url-filtering&gt;
</content>
  </example>
  <command name="IMPORT">
    <operation>type=config&amp;action=show</operation>
    <xpath>/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/url-filtering</xpath>
    <parser>
      <section>
        <xpath>//url-filtering/entry</xpath>
      </section>
      <lines>
        <line>
          <xpath>//entry/@name</xpath>
          <regexp>@name="(?&lt;object_id&gt;.*)"@</regexp>
        </line>
        
        <line>
          <xpath>//entry/dynamic-url</xpath>
          <regexp>@&lt;dynamic-url&gt;(?&lt;dynamic_url&gt;[^&lt;]+)&lt;/dynamic-url&gt;@</regexp>
        </line>
        <line>
          <xpath>//entry/enable-container-page</xpath>
          <regexp>@&lt;enable-container-page&gt;(?&lt;enable_container_page&gt;[^&lt;]+)&lt;/enable-container-page&gt;@</regexp>
        </line>
        
        <line>
          <xpath>//entry/license-expired</xpath>
          <regexp>@&lt;license-expired&gt;(?&lt;license_expired&gt;[^&lt;]+)&lt;/license-expired&gt;@</regexp>
        </line>
        <line>
          <xpath>//entry/log-container-page-only</xpath>
          <regexp>@&lt;log-container-page-only&gt;(?&lt;log_container_page_only&gt;[^&lt;]+)&lt;/log-container-page-only&gt;@</regexp>
        </line>
        <line>
          <xpath>//entry/description</xpath>
          <regexp>@&lt;description&gt;(?&lt;description&gt;[^&lt;]+)&lt;/description&gt;@</regexp>
        </line>
        <line>
          <xpath>//entry/action</xpath>
          <regexp>@&lt;action&gt;(?&lt;action&gt;[^&lt;]+)&lt;/action&gt;@</regexp>
        </line>
        <line>
          <array name="allow_list">
            <xpath>//entry/allow-list/member</xpath>
            <lines>
              <line>
                <xpath>//member</xpath>
                <regexp>@&lt;member&gt;(?&lt;url&gt;[^&lt;]+)&lt;/member&gt;@</regexp>
              </line>
            </lines>
          </array>
        </line>
        <line>
          <array name="block_list">
            <xpath>//entry/block-list/member</xpath>
            <lines>
              <line>
                <xpath>//member</xpath>
                <regexp>@&lt;member&gt;(?&lt;url&gt;[^&lt;]+)&lt;/member&gt;@</regexp>
              </line>
            </lines>
          </array>
        </line>
        
        
        <line>
          <array name="continue">
            <xpath>//entry/continue/member</xpath>
            <lines>
              <line>
                <xpath>//member</xpath>
                <regexp>@&lt;member&gt;(?&lt;member&gt;[^&lt;]+)&lt;/member&gt;@</regexp>
              </line>
            </lines>
          </array>
        </line>
        <line>
          <array name="block">
            <xpath>//entry/block/member</xpath>
            <lines>
              <line>
                <xpath>//member</xpath>
                <regexp>@&lt;member&gt;(?&lt;member&gt;[^&lt;]+)&lt;/member&gt;@</regexp>
              </line>
            </lines>
          </array>
        </line>
        <line>
          <array name="alert">
            <xpath>//entry/alert/member</xpath>
            <lines>
              <line>
                <xpath>//member</xpath>
                <regexp>@&lt;member&gt;(?&lt;member&gt;[^&lt;]+)&lt;/member&gt;@</regexp>
              </line>
            </lines>
          </array>
        </line>
      </lines>
    </parser>
  <post_template/>
  </command>
<command name="CREATE">
    <rest>type=config&amp;action=set
</rest>
    <xpath>/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/url-filtering
</xpath>
    <operation>&lt;entry name='{$params.object_id}'&gt;
{if !empty($params.description) }
&lt;description&gt;{$params.description}&lt;/description&gt;
{/if}
{if !empty($params.alert) }
&lt;alert&gt;
{foreach $params.alert as $alert}
&lt;member&gt;{$alert.member}&lt;/member&gt;
{/foreach}
&lt;/alert&gt;
{/if}
{if !empty($params.block) }
&lt;block&gt;
{foreach $params.block as $block}
&lt;member&gt;{$block.member}&lt;/member&gt;
{/foreach}
&lt;/block&gt;
{/if}
{if !empty($params.continue) }
&lt;continue&gt;
{foreach $params.continue as $continue}
&lt;member&gt;{$continue.member}&lt;/member&gt;
{/foreach}
&lt;/continue&gt;
{/if}
{if !empty($params.block_list) }
&lt;block-list&gt;
{foreach $params.block_list as $block_list}
&lt;member&gt;{$block_list.url}&lt;/member&gt;
{/foreach}
&lt;/block-list&gt;
{/if}
{if !empty($params.allow_list) }
&lt;allow-list&gt;
{foreach $params.allow_list as $allow_list}
&lt;member&gt;{$allow_list.url}&lt;/member&gt;
{/foreach}
&lt;/allow-list&gt;
{/if}
&lt;action&gt;{$params.action}&lt;/action&gt;
&lt;/entry&gt;
</operation>
  </command>
  <command name="UPDATE">
    <rest>type=config&amp;action=edit
</rest>
    <xpath>/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/url-filtering/entry[@name='{$params.object_id}']
</xpath>
    <operation>&lt;entry name='{$params.object_id}'&gt;
{if !empty($params.description) }
&lt;description&gt;{$params.description}&lt;/description&gt;
{/if}
{if !empty($params.alert) }
&lt;alert&gt;
{foreach $params.alert as $alert}
&lt;member&gt;{$alert.member}&lt;/member&gt;
{/foreach}
&lt;/alert&gt;
{/if}
{if !empty($params.block) }
&lt;block&gt;
{foreach $params.block as $block}
&lt;member&gt;{$block.member}&lt;/member&gt;
{/foreach}
&lt;/block&gt;
{/if}
{if !empty($params.continue) }
&lt;continue&gt;
{foreach $params.continue as $continue}
&lt;member&gt;{$continue.member}&lt;/member&gt;
{/foreach}
&lt;/continue&gt;
{/if}
{if !empty($params.block_list) }
&lt;block-list&gt;
{foreach $params.block_list as $block_list}
&lt;member&gt;{$block_list.url}&lt;/member&gt;
{/foreach}
&lt;/block-list&gt;
{/if}
{if !empty($params.allow_list) }
&lt;allow-list&gt;
{foreach $params.allow_list as $allow_list}
&lt;member&gt;{$allow_list.url}&lt;/member&gt;
{/foreach}
&lt;/allow-list&gt;
{/if}
&lt;action&gt;{$params.action}&lt;/action&gt;
&lt;/entry&gt;
</operation>
  </command>
  <command name="DELETE">
    <rest>type=config&amp;action=delete
</rest>
    <xpath>/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/profiles/url-filtering/entry[@name='{$params.object_id}']
</xpath>
    <operation>
</operation>
  </command>
</ObjectDefinition>
